<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡Œæ­å’–å•¡é¤¨ï¼šå¾è›»è®Šåˆ°å¹³è¡¡ | Leo's CafÃ©</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fdfbf7; /* Creamy White */
            color: #3e3232; /* Dark Coffee */
        }
        
        .coffee-gradient {
            background: linear-gradient(135deg, #4b3621 0%, #8b5a2b 100%);
        }

        .phase-btn.active {
            background-color: #8b5a2b; /* Medium Roast Brown */
            color: white;
            border-color: #8b5a2b;
        }

        /* Custom Scrollbar for inner content */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c7a17a; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a07855; 
        }

        /* Chart Container Utilities */
        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>

    <!-- Chosen Palette: Warm Coffee Tones -->
    <!-- Primary: #4b3621 (Dark Roast), Secondary: #8b5a2b (Medium Roast/Maillard), Background: #fdfbf7 (Milk Foam) -->

    <!-- Application Structure Plan: 
         1. Hero Section: Introduction to Leo's CafÃ© story.
         2. Interactive Master Roast Curve: The central navigation piece. Clicking phases on the chart updates the detailed content below. The curve now features the critical "å›æº«é»" and "è½‰é»ƒ" events as per the source image.
         3. Dynamic Content Panels:
            - è„«æ°´æœŸ (Drying): Crossing the threshold (Turning Point) and initial adaptation.
            - è½‰é»ƒæœŸ (Yellowing): Start of Maillard and the shift from "green" to "yellow" (First visible change). Data viz on Cost Savings.
            - é¢¨å‘³ç™¼å±•æœŸ (Flavor Development): Caramelization, Cracks, SEL Matrix, and Mindfulness.
         4. Conclusion: Summary of the philosophy.
         Why: This structure accurately mirrors the image's technical stages while maintaining the emotional and chronological flow of the story.
    -->

    <!-- Visualization & Content Choices:
         - Master Roast Curve (Line Chart): Visualizes the physical journey, including the drop to the Turning Point. Interaction: Click to filter content.
         - Cost Comparison (Bar Chart): Quantitative proof of the cost catalyst (placed in the crucial transition phase).
         - Mindfulness Canvas: A pulsating circle simulating "RoR" focus.
         - SEL Matrix: Interactive HTML grid.
         - NO SVG/Mermaid: All graphics via Canvas or CSS/HTML.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="coffee-gradient text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-wide">â˜• é‡Œæ­å’–å•¡é¤¨ Leo's CafÃ©</h1>
            <nav class="hidden md:flex space-x-6 text-sm font-medium">
                <button onclick="scrollToSection('intro')" class="hover:text-amber-200 transition">ç·£èµ·</button>
                <button onclick="scrollToSection('roast-journey')" class="hover:text-amber-200 transition">çƒ˜ç„™æ—…ç¨‹</button>
                <button onclick="scrollToSection('sel-mindfulness')" class="hover:text-amber-200 transition">æƒ…ç·’å­¸ç¿’</button>
            </nav>
        </div>
    </header>

    <!-- Intro Section -->
    <section id="intro" class="container mx-auto px-4 py-12 md:py-20 text-center max-w-4xl">
        <h2 class="text-3xl md:text-5xl font-bold mb-6 text-amber-900">å¾æ‹‰èŠ±æ‹¿éµåˆ°æ‰‹çƒ˜é»‘é‡‘</h2>
        <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-8">
            é€™ä¸åƒ…æ˜¯ä¸€æ¯å’–å•¡çš„é¢¨å‘³è›»è®Šï¼Œæ›´æ˜¯ä¸€å ´é—œæ–¼<strong>è¦ºå¯Ÿã€å¤±æªèˆ‡å¹³è¡¡</strong>çš„æƒ…ç·’å­¸ç¿’ä¹‹æ—…ã€‚<br>
            é¢å°é»‘å’–å•¡çš„ç´”ç²¹ï¼Œæˆ‘å€‘ä¹ŸåŒæ™‚å­¸æœƒäº†é¢å°çœŸå¯¦çš„è‡ªæˆ‘èˆ‡å£“åŠ›ã€‚
        </p>
        <div class="flex justify-center gap-4">
            <button onclick="scrollToSection('roast-journey')" class="bg-amber-800 hover:bg-amber-900 text-white font-bold py-3 px-8 rounded-full transition shadow-md transform hover:scale-105">
                é–‹å§‹æ¢ç´¢çƒ˜ç„™æ›²ç·š
            </button>
        </div>
    </section>

    <!-- Main Interactive Dashboard -->
    <main class="flex-grow container mx-auto px-4 pb-20 space-y-16">

        <!-- Section 1: The Master Roast Curve (Navigation Hub) -->
        <section id="roast-journey" class="bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-amber-100">
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-amber-900 mb-2">ğŸ”¥ çƒ˜ç„™å‡æº«æ›²ç·š (Roasting Curve)</h3>
                <p class="text-gray-600">
                    é»æ“Šä¸‹æ–¹åœ–è¡¨ä¸­çš„ä¸åŒéšæ®µæˆ–æŒ‰éˆ•ï¼Œæ¢ç´¢é‡Œæ­çš„å’–å•¡èˆ‡å¿ƒè·¯æ­·ç¨‹ã€‚æ›²ç·šåŒ…å«äº†ã€Œå›æº«é»ã€ã€ã€Œè½‰é»ƒã€ç­‰é—œéµäº‹ä»¶ã€‚
                </p>
            </div>

            <!-- Chart Container -->
            <div class="w-full h-[300px] md:h-[400px] chart-wrapper mb-8">
                <div class="relative w-full h-full max-w-4xl mx-auto">
                    <canvas id="roastCurveChart"></canvas>
                </div>
            </div>

            <!-- Phase Control Buttons (Alternative Navigation) -->
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button onclick="updatePhase('drying')" id="btn-drying" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition">
                    1. è„«æ°´æœŸ
                </button>
                <button onclick="updatePhase('yellowing')" id="btn-yellowing" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition">
                    2. è½‰é»ƒæœŸ
                </button>
                <button onclick="updatePhase('development')" id="btn-development" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition">
                    3. é¢¨å‘³ç™¼å±•æœŸ
                </button>
            </div>

            <!-- Dynamic Content Area -->
            <div id="dynamic-content" class="bg-amber-50 rounded-xl p-6 md:p-10 transition-all duration-500 ease-in-out min-h-[400px]">
                <!-- Content will be injected here via JS -->
            </div>
        </section>

        <!-- Section 2: SEL & Mindfulness Deep Dive -->
        <section id="sel-mindfulness" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Left Col: SEL Matrix -->
            <div class="bg-white rounded-2xl shadow-xl p-6 border-l-8 border-amber-700">
                <h3 class="text-2xl font-bold text-amber-900 mb-4">ğŸ§  æƒ…ç·’å­¸ç¿’å°ç…§è¡¨ (SEL Matrix)</h3>
                <p class="text-sm text-gray-500 mb-6">å°‡çƒ˜ç„™çš„ç‰©ç†åŒ–å­¸è®ŠåŒ–ï¼Œå°æ‡‰åˆ°æ•™å¸«çš„æƒ…ç·’ç®¡ç†æ­·ç¨‹ã€‚</p>
                
                <div class="space-y-4">
                    <div class="group p-4 border border-gray-200 rounded-lg hover:bg-amber-50 hover:border-amber-300 transition cursor-pointer">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-lg text-amber-800">è„«æ°´æœŸ (Drying)</h4>
                            <span class="text-xs bg-gray-200 px-2 py-1 rounded">å…¥è±† $\rightarrow$ è½‰é»ƒ</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2"><strong>ç‰©ç†ï¼š</strong> å›æº«é»æ˜¯æœ€ä½è°·ã€‚æ’å‡ºæ°´åˆ†ã€‚</p>
                        <div class="pl-4 border-l-2 border-amber-500">
                            <p class="text-amber-700 font-medium text-sm">â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šå£“åŠ›èªçŸ¥èˆ‡æ¸…ç©º</p>
                            <p class="text-gray-500 text-xs mt-1">ç¶“æ­·ã€Œå›æº«é»ã€çš„ä½æ½®å¾Œï¼Œé–‹å§‹ç©©æ­¥å‡æº«ã€‚æ„è­˜åˆ°å£“åŠ›ï¼Œä¸¦ç‚ºæ–°çš„æ”¹è®Šåšæº–å‚™ã€‚</p>
                        </div>
                    </div>

                    <div class="group p-4 border border-gray-200 rounded-lg hover:bg-amber-50 hover:border-amber-300 transition cursor-pointer">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-lg text-amber-800">è½‰é»ƒæœŸ (Yellowing)</h4>
                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">è½‰é»ƒ $\rightarrow$ æ¢…ç´å§‹</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2"><strong>åŒ–å­¸ï¼š</strong> è±†å­è½‰é»ƒï¼Œæ¢…ç´åæ‡‰é–‹å§‹ã€‚é¢¨å‘³å‰é©…ç‰©ç”Ÿæˆã€‚</p>
                        <div class="pl-4 border-l-2 border-amber-500">
                            <p class="text-amber-700 font-medium text-sm">â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šè¦ºå¯Ÿèˆ‡æ ¡æº–</p>
                            <p class="text-gray-500 text-xs mt-1">é€²å…¥è¤‡é›œçš„åŒ–å­¸åæ‡‰å€ã€‚éœ€è¦é«˜å°ˆæ³¨åº¦ï¼Œå°‡ã€Œå¤±æªã€è¦–ç‚ºæ•¸æ“šé»ï¼Œé€²è¡Œç²¾æº–æ ¡æº–ã€‚</p>
                        </div>
                    </div>

                    <div class="group p-4 border border-gray-200 rounded-lg hover:bg-amber-50 hover:border-amber-300 transition cursor-pointer">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-lg text-amber-800">é¢¨å‘³ç™¼å±•æœŸ (Development)</h4>
                            <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">ç„¦ç³–å§‹ $\rightarrow$ äºŒçˆ†</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2"><strong>åŒ–å­¸ï¼š</strong> ç„¦ç³–åŒ–ã€ä¸€çˆ†ã€äºŒçˆ†ã€‚å£“åŠ›å®Œå…¨é‡‹æ”¾ã€‚</p>
                        <div class="pl-4 border-l-2 border-amber-500">
                            <p class="text-amber-700 font-medium text-sm">â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šé‡‹æ”¾èˆ‡å¹³è¡¡</p>
                            <p class="text-gray-500 text-xs mt-1">ä¸€çˆ†æ˜¯å£“åŠ›é‡‹æ”¾ã€‚æ­¤å¾Œéœ€**ç©©å®š RoR**ï¼Œåœ¨ç†±æƒ… (é…¸è³ª) èˆ‡ç©©å®š (é†‡åšåº¦) é–“æ‰¾åˆ°å¹³è¡¡ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Col: Mindfulness Visualizer -->
            <div class="bg-gray-900 rounded-2xl shadow-xl p-6 text-white flex flex-col items-center justify-center relative overflow-hidden">
                <div class="absolute top-4 left-4 z-10">
                    <h3 class="text-xl font-bold text-amber-400">ğŸ§˜ å’–å•¡é¦™æ°£æ­£å¿µ</h3>
                    <p class="text-xs text-gray-400">æ¨¡æ“¬ Artisan æ›²ç·šç›£æ§ï¼šé»æ“Šä»¥ã€Œç©©å®šã€æ‚¨çš„ RoR</p>
                </div>

                <!-- Canvas for Mindfulness Animation -->
                <div class="w-full h-[300px] flex items-center justify-center relative z-0">
                    <canvas id="mindfulnessCanvas" width="300" height="300"></canvas>
                </div>

                <div class="text-center mt-4 z-10">
                    <p id="focus-instruction" class="text-sm text-gray-300 animate-pulse">
                        ç•¶é»ƒè‰²åœ“åœˆæ“´å¤§æ™‚ (å£“åŠ›å‡æº«)ï¼Œ<br>é»æ“Šåœ“åœˆä¸­å¿ƒä»¥é€²è¡Œã€Œèª¿ç¯€å‘¼å¸ã€ã€‚
                    </p>
                </div>
            </div>

        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-amber-950 text-amber-100 py-8">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-xl font-bold mb-2">é‡Œæ­å’–å•¡é¤¨ Leo's CafÃ©</h2>
            <p class="text-sm opacity-75 max-w-2xl mx-auto">
                ã€Œäº«å—é€™å€‹ã€å¤±æªã€èˆ‡ã€æ¢ç´¢ã€çš„æ­·ç¨‹ï¼Œå› ç‚ºæ‰€æœ‰çš„æŒ«æŠ˜ï¼Œæœ€çµ‚éƒ½æœƒæ¿ƒç¸®æˆä¸€æ¯ç¨ç‰¹çš„é¢¨å‘³ã€‚ã€
            </p>
            <!-- åŠ å…¥é‡Œæ­çš„å€‹äººå­¸ç¿’ç©ºé–“é€£çµ -->
            <div class="mt-4">
                <a href="https://dfleoyang-8157.github.io/hello/" target="_blank" class="text-amber-300 hover:text-white transition font-medium text-sm underline">
                    ğŸš€ æ¢ç´¢é‡Œæ­çš„å€‹äººå­¸ç¿’ç©ºé–“
                </a>
            </div>
            <div class="mt-4 text-xs text-gray-500">
                Created based on the workshop presentation data.
            </div>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- State Management ---
        const state = {
            currentPhase: 'drying',
            chartInstance: null,
            costChartInstance: null,
            mindfulness: {
                radius: 50,
                growing: true,
                score: 0,
                animationId: null
            }
        };

        // --- Data: Roast Curve (UPDATED based on user request: 200Â°C -> 100Â°C @ 2:00 -> 210Â°C @ 11:00) ---
        const roastData = {
            // New labels aligning with the 11-minute timeline and new events
            labels: ['0:00 å…¥è±†', '1:00', '2:00 å›æº«é»', '3:00 è½‰é»ƒ', '4:00 æ¢…ç´å§‹', '5:00', '6:00 ç„¦ç³–å§‹', '7:00', '8:00 ä¸€çˆ†', '9:00', '10:00 äºŒçˆ†', '11:00 çµæŸ'],
            // New temperature curve: Drop from 200 to 100 (Turning Point) then rise to 210
            temps: [200, 140, 100, 115, 145, 160, 175, 188, 198, 203, 208, 210],
            // Phase definitions based on the new timings
            phases: {
                drying: { start: 0, end: 3, label: 'è„«æ°´æœŸ' }, // End at 3:00 (index 3, which is è½‰é»ƒ)
                yellowing: { start: 3, end: 4, label: 'è½‰é»ƒæœŸ' }, // End at 4:00 (index 4, which is æ¢…ç´å§‹)
                development: { start: 4, end: 11, label: 'é¢¨å‘³ç™¼å±•æœŸ' }
            },
            // Specific event indices: [Turning Point, Yellowing, Maillard Start, Caramel Start, First Crack, Second Crack]
            eventIndices: [2, 3, 4, 6, 8, 10] 
        };

        // --- Data: Content Content (Updated for new phases) ---
        const contentData = {
            drying: {
                title: "ç¬¬ä¸€éƒ¨ï¼šè„«æ°´æœŸ (Drying Phase) - å£“åŠ›æœ€ä½è°·",
                subtitle: "å¾æ‹¿éµçš„æ©è“‹åˆ°é¢å°é»‘å’–å•¡çš„æœ¬è³ª",
                body: `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                        <div>
                            <p class="mb-4 text-lg">
                                çƒ˜ç„™åˆæœŸï¼Œè±†æº«æœƒç¶“æ­·ä¸€å€‹æˆ²åŠ‡æ€§çš„ä¸‹é™ï¼Œç›´åˆ°è§¸åŠ<strong>å›æº«é»</strong>ï¼ˆç´„ ${roastData.temps[2]}Â°Cï¼‰ã€‚é€™ä»£è¡¨äº†åœ¨é–‹å§‹å­¸ç¿’å‰ï¼Œå¿…é ˆå…ˆé©æ‡‰ç’°å¢ƒå’Œå·¥å…·ã€‚
                            </p>
                            <p class="mb-4">
                                æƒ…ç·’ä¸Šï¼Œé€™æ˜¯å¾èˆŠç¿’æ…£ï¼ˆæ‹¿éµçš„èˆ’é©åœˆï¼‰åˆ°æ–°ç’°å¢ƒï¼ˆæ‰‹çƒ˜é»‘å’–å•¡ï¼‰çš„é©æ‡‰æœŸã€‚å¿…é ˆå…ˆè„«å»ã€Œæ°´åˆ†ã€ï¼ˆèˆŠçš„ä¾è³´ï¼‰ï¼Œæ‰èƒ½é–‹å§‹å‡æº«ã€‚
                            </p>
                            <div class="bg-white p-4 rounded-lg shadow-sm border-l-4 border-amber-300">
                                <h4 class="font-bold text-amber-800 mb-1">é—œéµäº‹ä»¶ï¼šå›æº«é» (2:00)</h4>
                                <p class="text-sm text-gray-600">åº¦éæœ€ä½è°·ï¼Œé–‹å§‹ç©©æ­¥å‡æº«ã€‚ç¢ºèªç›®æ¨™å¾Œï¼Œå¿…é ˆç©©å®šæŠ•å…¥ç†±é‡ã€‚</p>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-inner text-center">
                            <div class="text-6xl mb-4 transition-transform hover:scale-110 cursor-pointer">ğŸ“‰ â” ğŸ“ˆ</div>
                            <p class="font-bold text-amber-900">åº¦éä½è°·ï¼Œé–‹å§‹å‡æº«</p>
                            <p class="text-sm text-gray-500 mt-2">å¦‚åŒé©æ‡‰æ–°å·¥ä½œç’°å¢ƒæˆ–æŒ‘æˆ°ï¼Œå¾è°·åº•é–‹å§‹ï¼Œæ‰èƒ½ç©©å¥æˆé•·ã€‚</p>
                        </div>
                    </div>
                `
            },
            yellowing: {
                title: "ç¬¬äºŒéƒ¨ï¼šè½‰é»ƒæœŸ (Yellowing Phase) - é¢¨å‘³èµ·å§‹é»",
                subtitle: "æ¢…ç´åæ‡‰é–‹å§‹ï¼šæˆæœ¬å£“åŠ›ä¸‹çš„ç²¾æº–è¦ºå¯Ÿ",
                body: `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="mb-4 text-lg">
                                è±†å­å¾ç¶ è‰²è½‰ç‚ºé»ƒè‰² (<strong>è½‰é»ƒ</strong>ï¼Œç´„ ${roastData.labels[3].split(' ')[0]})ï¼Œæ¨™èªŒè‘—<strong>æ¢…ç´åæ‡‰é–‹å§‹</strong>ï¼ˆç´„ ${roastData.labels[4].split(' ')[0]}ï¼‰ã€‚é€™æ˜¯èƒºåŸºé…¸èˆ‡é‚„åŸç³–ä½œç”¨ï¼Œå½¢æˆè¤‡é›œé¢¨å‘³å‰é©…ç‰©çš„é—œéµéšæ®µã€‚
                            </p>
                            <p class="mb-4">
                                æ­£æ˜¯é«˜åƒ¹ç²¾å“è±†çš„æˆæœ¬å£“åŠ›ï¼Œä¿ƒä½¿æˆ‘æ±ºå¿ƒé€²å…¥é€™è¤‡é›œçš„é ˜åŸŸï¼Œå¾æ‰‹å¯«ç­†è¨˜åˆ° **Arduino + Artisan** æ•¸ä½åŒ–ï¼Œè¿½æ±‚ç²¾æº–åº¦ã€‚
                            </p>
                            <p class="text-sm text-gray-500 italic">"åœ¨è¤‡é›œçš„åŒ–å­¸åæ‡‰ä¸­ï¼Œæˆ‘å€‘å¿…é ˆç”¨æ•¸æ“šä¾†æ ¡æº–ï¼Œé¿å…å¤±æªã€‚"</p>
                        </div>
                        <div class="chart-wrapper h-64 bg-white rounded-lg p-2">
                            <div class="relative w-full h-full">
                                <canvas id="costChart"></canvas>
                            </div>
                        </div>
                    </div>
                `
            },
            development: {
                title: "ç¬¬ä¸‰éƒ¨ï¼šé¢¨å‘³ç™¼å±•æœŸ (Development Phase) - é‡‹æ”¾èˆ‡å¹³è¡¡",
                subtitle: "ç„¦ç³–åŒ–èˆ‡çˆ†è£‚è²ï¼šæƒ…ç·’çš„èª¿ç¯€è—è¡“",
                body: `
                    <div class="space-y-4">
                        <p class="text-lg">
                            æ­¤éšæ®µå¾<strong>ç„¦ç³–åŒ–åæ‡‰é–‹å§‹</strong>ï¼ˆç´„ ${roastData.labels[6].split(' ')[0]}ï¼‰ï¼Œæ­·ç¶“<strong>ä¸€çˆ†</strong>å’Œ<strong>äºŒçˆ†</strong>ã€‚ä¸€çˆ†æ˜¯è±†å­å…§éƒ¨å£“åŠ›ç©èšå¾Œçš„åŠ‡çƒˆé‡‹æ”¾ï¼Œåƒæ¥µäº†æˆ‘å€‘åœ¨å·¥ä½œä¸­çš„æƒ…ç·’çˆ†ç™¼ã€‚
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                            <div class="bg-red-50 p-4 rounded-lg">
                                <h4 class="font-bold text-red-800">ğŸ”¥ å‡æº« (Acidity)</h4>
                                <p class="text-xs text-gray-600 mt-1">ä»£è¡¨ä¿æŒç†±å¿±èˆ‡é…¸è³ª</p>
                            </div>
                            <div class="bg-amber-50 p-4 rounded-lg">
                                <h4 class="font-bold text-amber-800">âš–ï¸ å¹³è¡¡ (Balance)</h4>
                                <p class="text-xs text-gray-600 mt-1">æ§åˆ¶ RoRï¼Œå°‹æ‰¾ç”œèœœé»</p>
                            </div>
                            <div class="bg-brown-50 p-4 rounded-lg" style="background-color: #efebe9;">
                                <h4 class="font-bold text-amber-950">ğŸªµ é†‡åš (Body)</h4>
                                <p class="text-xs text-gray-600 mt-1">ä»£è¡¨ç¶­æŒç©©å®šèˆ‡å£æ„Ÿ</p>
                            </div>
                        </div>
                        <p class="mt-4">
                            ä¸€çˆ†å¾Œçš„ç™¼å±•æ™‚é–“ï¼Œæ±ºå®šäº†é¢¨å‘³çš„å¹³è¡¡ã€‚å¦‚åŒå£“åŠ›é‡‹æ”¾å¾Œï¼Œæˆ‘å€‘å¿…é ˆ**å¿«é€Ÿé™æº«**ï¼Œé¿å…éåº¦ç„¦åŒ– (æƒ…ç·’å¤±æ§)ï¼Œæ‰¾åˆ°ç†±å¿±èˆ‡ç©©å®šçš„æœ€ä½³å¹³è¡¡é»ã€‚
                        </p>
                        <div class="text-center mt-6">
                            <button onclick="document.getElementById('sel-mindfulness').scrollIntoView({behavior: 'smooth'})" class="text-amber-600 font-bold hover:underline">
                                ğŸ‘‡ ä¸‹æ»‘é«”é©—ã€Œå’–å•¡é¦™æ°£æ­£å¿µã€ç·´ç¿’
                            </button>
                        </div>
                    </div>
                `
            }
        };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initRoastChart();
            updatePhase('drying'); // Load initial content
            initMindfulness();
        });

        // --- Logic: Roasting Chart ---
        function initRoastChart() {
            const ctx = document.getElementById('roastCurveChart').getContext('2d');
            
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(139, 69, 19, 0.8)');
            gradient.addColorStop(1, 'rgba(139, 69, 19, 0.1)');

            // Prepare point styles for key events
            const pointStyles = roastData.temps.map((_, index) => {
                if (roastData.eventIndices.includes(index)) {
                    return 8; // Larger point for key events
                }
                return 4; // Smaller default point
            });
            const pointColors = roastData.temps.map((_, index) => {
                if (roastData.eventIndices.includes(index)) {
                    return '#a0522d'; // Sienna for key events
                }
                return '#fff'; 
            });


            state.chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: roastData.labels,
                    datasets: [{
                        label: 'è±†æº« (Bean Temp Â°C)',
                        data: roastData.temps,
                        borderColor: '#8b4513',
                        backgroundColor: gradient,
                        borderWidth: 3,
                        pointBackgroundColor: pointColors,
                        pointBorderColor: '#8b4513',
                        pointRadius: pointStyles,
                        pointHoverRadius: 10,
                        fill: true,
                        tension: 0.2 // Reduced tension for a slightly smoother, but more structured curve
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = `æº«åº¦: ${context.parsed.y}Â°C`;
                                    if (roastData.eventIndices.includes(context.dataIndex)) {
                                        label += ` | ${roastData.labels[context.dataIndex].split(' ')[1] || 'äº‹ä»¶'}`;
                                    }
                                    return label;
                                },
                                afterLabel: function(context) {
                                    const idx = context.dataIndex;
                                    if (idx <= 3) return "éšæ®µ: è„«æ°´æœŸ"; // Changed from 2 to 3
                                    if (idx > 3 && idx <= 4) return "éšæ®µ: è½‰é»ƒæœŸ";
                                    return "éšæ®µ: é¢¨å‘³ç™¼å±•æœŸ";
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 0,
                            max: 230,
                            grid: { color: 'rgba(0,0,0,0.05)' },
                            title: { display: true, text: 'æº«åº¦ (Â°C)' }
                        },
                        x: {
                            grid: { display: false },
                            title: { display: true, text: 'æ™‚é–“ (åˆ†)' }
                        }
                    },
                    onClick: (e, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            if (index <= 3) updatePhase('drying'); // Changed from 2 to 3
                            else if (index > 3 && index <= 4) updatePhase('yellowing');
                            else updatePhase('development');
                        }
                    }
                }
            });
        }

        // --- Logic: Cost Chart (Loaded dynamically) ---
        function initCostChart() {
            const ctx = document.getElementById('costChart');
            if (!ctx) return; 

            if (state.costChartInstance) state.costChartInstance.destroy();

            state.costChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['å¤–è³¼ç²¾å“è±†', 'è‡ªå·±çƒ˜ç„™'],
                    datasets: [{
                        label: 'æ¯åŠç£…æˆæœ¬ (NT$)',
                        data: [500, 150],
                        backgroundColor: ['#ef4444', '#22c55e'],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'æˆæœ¬æ¯”è¼ƒï¼šå·¨å¤§çš„è¡Œå‹•å‹•åŠ›' }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        // --- Logic: Phase Update & Navigation ---
        function updatePhase(phaseId) {
            state.currentPhase = phaseId;

            document.querySelectorAll('.phase-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${phaseId}`).classList.add('active');

            const container = document.getElementById('dynamic-content');
            const data = contentData[phaseId];
            
            container.style.opacity = '0';
            setTimeout(() => {
                container.innerHTML = `
                    <h3 class="text-2xl font-bold text-amber-900 mb-2">${data.title}</h3>
                    <h4 class="text-lg text-amber-600 mb-6 font-medium">${data.subtitle}</h4>
                    <div class="text-gray-700 leading-relaxed space-y-4">
                        ${data.body}
                    </div>
                `;
                container.style.opacity = '1';

                if (phaseId === 'yellowing') {
                    setTimeout(initCostChart, 100);
                }
            }, 300);

            updateChartColors(phaseId);
        }

        function updateChartColors(phaseId) {
            if (!state.chartInstance) return;
            
            const newColors = [];
            const labels = state.chartInstance.data.labels;
            
            labels.forEach((_, index) => {
                let isActive = false;
                if (phaseId === 'drying' && index <= 3) isActive = true; // Changed from 2 to 3
                else if (phaseId === 'yellowing' && index > 3 && index <= 4) isActive = true; // Changed from 2 to 3
                else if (phaseId === 'development' && index > 4) isActive = true;
                
                newColors.push(roastData.eventIndices.includes(index) ? (isActive ? '#d97706' : '#a0522d') : (isActive ? '#d97706' : '#fff'));
            });

            state.chartInstance.data.datasets[0].pointBackgroundColor = newColors;
            state.chartInstance.data.datasets[0].pointRadius = newColors.map((c, index) => {
                if (roastData.eventIndices.includes(index)) return 8;
                return c === '#d97706' ? 6 : 4; 
            });
            state.chartInstance.update();
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // --- Logic: Mindfulness Canvas Animation ---
        function initMindfulness() {
            const canvas = document.getElementById('mindfulnessCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;

            canvas.addEventListener('click', () => {
                state.mindfulness.radius = Math.max(30, state.mindfulness.radius - 20);
                state.mindfulness.growing = true;
                showFeedback("æ ¡æº–æˆåŠŸï¼ä¿æŒå°ˆæ³¨...", "#22c55e");
            });

            function showFeedback(text, color) {
                const el = document.getElementById('focus-instruction');
                const originalText = el.innerHTML;
                el.innerHTML = `<span style="color:${color}">${text}</span>`;
                setTimeout(() => {
                    el.innerHTML = `ç•¶é»ƒè‰²åœ“åœˆæ“´å¤§æ™‚ (å£“åŠ›å‡æº«)ï¼Œ<br>é»æ“Šåœ“åœˆä¸­å¿ƒä»¥é€²è¡Œã€Œèª¿ç¯€å‘¼å¸ã€ã€‚`;
                }, 1500);
            }

            function animate() {
                ctx.clearRect(0, 0, width, height);

                ctx.beginPath();
                ctx.arc(centerX, centerY, 80, 0, Math.PI * 2);
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.lineWidth = 2;
                ctx.stroke();

                if (state.mindfulness.growing) {
                    state.mindfulness.radius += 0.3;
                    if (state.mindfulness.radius > 100) {
                        state.mindfulness.growing = false;
                        showFeedback("æº«åº¦éé«˜ï¼å¤±æªè­¦å‘Šï¼", "#ef4444");
                    }
                } else {
                    state.mindfulness.radius -= 0.2;
                    if (state.mindfulness.radius < 40) {
                        state.mindfulness.growing = true;
                    }
                }

                const gradient = ctx.createRadialGradient(centerX, centerY, 10, centerX, centerY, state.mindfulness.radius);
                gradient.addColorStop(0, '#f59e0b');
                gradient.addColorStop(1, 'rgba(245, 158, 11, 0.1)');

                ctx.beginPath();
                ctx.arc(centerX, centerY, state.mindfulness.radius, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                ctx.strokeStyle = '#fbbf24';
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.fillStyle = "white";
                ctx.font = "14px monospace";
                ctx.textAlign = "center";
                ctx.fillText(`RoR: ${(state.mindfulness.growing ? '+' : '-')}${Math.abs(state.mindfulness.radius / 10).toFixed(1)}`, centerX, centerY + 5);

                requestAnimationFrame(animate);
            }

            animate();
        }

    </script>
</body>
</html>
