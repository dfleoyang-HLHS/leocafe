<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡Œæ­å’–å•¡é¤¨ï¼šå¾è›»è®Šåˆ°å¹³è¡¡ | Leo's CafÃ©</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #fdfbf7; /* Creamy White */
            color: #3e3232; /* Dark Coffee */
        }
        
        .coffee-gradient {
            background: linear-gradient(135deg, #4b3621 0%, #8b5a2b 100%);
        }

        .phase-btn.active {
            background-color: #8b5a2b; /* Medium Roast Brown */
            color: white;
            border-color: #8b5a2b;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c7a17a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a07855; }

        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        [data-lang]:hidden { display: none; }
    </style>

    <!-- Chosen Palette: Warm Coffee Tones -->
    <!-- Application Structure Plan: 
         - Bilingual implementation using JS state.
         - All technical roasting data points (200C start, Turning Point at 2:00, 210C end) maintained.
         - Interactive elements for SEL and Mindfulness.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="coffee-gradient text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold tracking-wide">â˜• é‡Œæ­å’–å•¡é¤¨ Leo's CafÃ©</h1>
            <div class="flex items-center space-x-4 md:space-x-8">
                <nav class="hidden md:flex space-x-6 text-sm font-medium">
                    <button onclick="scrollToSection('intro')" class="hover:text-amber-200 transition" data-i18n="nav_origin">ç·£èµ·</button>
                    <button onclick="scrollToSection('roast-journey')" class="hover:text-amber-200 transition" data-i18n="nav_journey">çƒ˜ç„™æ—…ç¨‹</button>
                    <button onclick="scrollToSection('sel-mindfulness')" class="hover:text-amber-200 transition" data-i18n="nav_sel">æƒ…ç·’å­¸ç¿’</button>
                </nav>
                <!-- Language Toggle -->
                <button onclick="toggleLanguage()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-full text-xs font-bold border border-white/50 transition">
                    <span id="lang-toggle-text">EN</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Intro Section -->
    <section id="intro" class="container mx-auto px-4 py-12 md:py-20 text-center max-w-4xl">
        <h2 class="text-3xl md:text-5xl font-bold mb-6 text-amber-900" data-i18n="hero_title">å¾æ‹‰èŠ±æ‹¿éµåˆ°æ‰‹çƒ˜é»‘é‡‘</h2>
        <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-8" data-i18n="hero_desc">
            é€™ä¸åƒ…æ˜¯ä¸€æ¯å’–å•¡çš„é¢¨å‘³è›»è®Šï¼Œæ›´æ˜¯ä¸€å ´é—œæ–¼è¦ºå¯Ÿã€å¤±æªèˆ‡å¹³è¡¡çš„æƒ…ç·’å­¸ç¿’ä¹‹æ—…ã€‚<br>
            é¢å°é»‘å’–å•¡çš„ç´”ç²¹ï¼Œæˆ‘å€‘ä¹ŸåŒæ™‚å­¸æœƒäº†é¢å°çœŸå¯¦çš„è‡ªæˆ‘èˆ‡å£“åŠ›ã€‚
        </p>
        <div class="flex justify-center gap-4">
            <button onclick="scrollToSection('roast-journey')" class="bg-amber-800 hover:bg-amber-900 text-white font-bold py-3 px-8 rounded-full transition shadow-md transform hover:scale-105" data-i18n="hero_btn">
                é–‹å§‹æ¢ç´¢çƒ˜ç„™æ›²ç·š
            </button>
        </div>
    </section>

    <!-- Main Interactive Dashboard -->
    <main class="flex-grow container mx-auto px-4 pb-20 space-y-16">

        <!-- Section 1: The Master Roast Curve -->
        <section id="roast-journey" class="bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-amber-100">
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-amber-900 mb-2" data-i18n="journey_title">ğŸ”¥ çƒ˜ç„™å‡æº«æ›²ç·š (Roasting Curve)</h3>
                <p class="text-gray-600" data-i18n="journey_desc">
                    é»æ“Šåœ–è¡¨ä¸­çš„éšæ®µæ¢ç´¢å¿ƒè·¯æ­·ç¨‹ã€‚æ›²ç·šåŒ…å«äº†ã€Œå›æº«é»ã€ã€ã€Œè½‰é»ƒã€ç­‰é—œéµäº‹ä»¶ã€‚
                </p>
            </div>

            <div class="w-full h-[300px] md:h-[400px] chart-wrapper mb-8">
                <div class="relative w-full h-full max-w-4xl mx-auto">
                    <canvas id="roastCurveChart"></canvas>
                </div>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button onclick="updatePhase('drying')" id="btn-drying" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition" data-i18n="phase1_btn">
                    1. è„«æ°´æœŸ
                </button>
                <button onclick="updatePhase('yellowing')" id="btn-yellowing" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition" data-i18n="phase2_btn">
                    2. è½‰é»ƒæœŸ
                </button>
                <button onclick="updatePhase('development')" id="btn-development" class="phase-btn px-6 py-2 border-2 border-amber-200 rounded-lg font-bold text-amber-900 hover:bg-amber-50 transition" data-i18n="phase3_btn">
                    3. é¢¨å‘³ç™¼å±•æœŸ
                </button>
            </div>

            <div id="dynamic-content" class="bg-amber-50 rounded-xl p-6 md:p-10 transition-all duration-500 ease-in-out min-h-[400px]">
                <!-- Dynamic Content -->
            </div>
        </section>

        <!-- Section 2: SEL & Mindfulness -->
        <section id="sel-mindfulness" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Left Col: SEL Matrix -->
            <div class="bg-white rounded-2xl shadow-xl p-6 border-l-8 border-amber-700">
                <h3 class="text-2xl font-bold text-amber-900 mb-4" data-i18n="matrix_title">ğŸ§  æƒ…ç·’å­¸ç¿’å°ç…§è¡¨ (SEL Matrix)</h3>
                <p class="text-sm text-gray-500 mb-6" data-i18n="matrix_desc">å°‡çƒ˜ç„™çš„ç‰©ç†åŒ–å­¸è®ŠåŒ–ï¼Œå°æ‡‰åˆ°æ•™å¸«çš„æƒ…ç·’ç®¡ç†æ­·ç¨‹ã€‚</p>
                
                <div class="space-y-4" id="sel-matrix-container">
                    <!-- Matrix items will be rendered by JS for bilingual support -->
                </div>
            </div>

            <!-- Right Col: Mindfulness Visualizer -->
            <div class="bg-gray-900 rounded-2xl shadow-xl p-6 text-white flex flex-col items-center justify-center relative overflow-hidden">
                <div class="absolute top-4 left-4 z-10">
                    <h3 class="text-xl font-bold text-amber-400" data-i18n="mind_title">ğŸ§˜ å’–å•¡é¦™æ°£æ­£å¿µ</h3>
                    <p class="text-xs text-gray-400" data-i18n="mind_subtitle">æ¨¡æ“¬ Artisan æ›²ç·šç›£æ§ï¼šé»æ“Šä»¥ã€Œç©©å®šã€æ‚¨çš„ RoR</p>
                </div>

                <div class="w-full h-[300px] flex items-center justify-center relative z-0">
                    <canvas id="mindfulnessCanvas" width="300" height="300"></canvas>
                </div>

                <div class="text-center mt-4 z-10">
                    <p id="focus-instruction" class="text-sm text-gray-300 animate-pulse" data-i18n="mind_hint">
                        ç•¶é»ƒè‰²åœ“åœˆæ“´å¤§æ™‚ (å£“åŠ›å‡æº«)ï¼Œé»æ“Šåœ“åœˆä¸­å¿ƒä»¥é€²è¡Œã€Œèª¿ç¯€å‘¼å¸ã€ã€‚
                    </p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-amber-950 text-amber-100 py-8">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-xl font-bold mb-2">é‡Œæ­å’–å•¡é¤¨ Leo's CafÃ©</h2>
            <p class="text-sm opacity-75 max-w-2xl mx-auto" data-i18n="footer_quote">
                ã€Œäº«å—é€™å€‹ã€å¤±æªã€èˆ‡ã€æ¢ç´¢ã€çš„æ­·ç¨‹ï¼Œå› ç‚ºæ‰€æœ‰çš„æŒ«æŠ˜ï¼Œæœ€çµ‚éƒ½æœƒæ¿ƒç¸®æˆä¸€æ¯ç¨ç‰¹çš„é¢¨å‘³ã€‚ã€
            </p>
            <div class="mt-4">
                <a href="https://dfleoyang-8157.github.io/hello/" target="_blank" class="text-amber-300 hover:text-white transition font-medium text-sm underline" data-i18n="footer_link">
                    ğŸš€ æ¢ç´¢é‡Œæ­çš„å€‹äººå­¸ç¿’ç©ºé–“
                </a>
            </div>
            <div class="mt-4 text-xs text-gray-500">
                Created for Leo's CafÃ© Workshop.
            </div>
        </div>
    </footer>

    <script>
        // --- Translations ---
        const i18n = {
            zh: {
                nav_origin: "ç·£èµ·", nav_journey: "çƒ˜ç„™æ—…ç¨‹", nav_sel: "æƒ…ç·’å­¸ç¿’",
                hero_title: "å¾æ‹‰èŠ±æ‹¿éµåˆ°æ‰‹çƒ˜é»‘é‡‘", hero_desc: "é€™ä¸åƒ…æ˜¯ä¸€æ¯å’–å•¡çš„é¢¨å‘³è›»è®Šï¼Œæ›´æ˜¯ä¸€å ´é—œæ–¼è¦ºå¯Ÿã€å¤±æªèˆ‡å¹³è¡¡çš„æƒ…ç·’å­¸ç¿’ä¹‹æ—…ã€‚<br>é¢å°é»‘å’–å•¡çš„ç´”ç²¹ï¼Œæˆ‘å€‘ä¹ŸåŒæ™‚å­¸æœƒäº†é¢å°çœŸå¯¦çš„è‡ªæˆ‘èˆ‡å£“åŠ›ã€‚",
                hero_btn: "é–‹å§‹æ¢ç´¢çƒ˜ç„™æ›²ç·š",
                journey_title: "ğŸ”¥ çƒ˜ç„™å‡æº«æ›²ç·š (Roasting Curve)", journey_desc: "é»æ“Šåœ–è¡¨ä¸­çš„éšæ®µæ¢ç´¢å¿ƒè·¯æ­·ç¨‹ã€‚æ›²ç·šåŒ…å«äº†ã€Œå›æº«é»ã€ã€ã€Œè½‰é»ƒã€ç­‰é—œéµäº‹ä»¶ã€‚",
                phase1_btn: "1. è„«æ°´æœŸ", phase2_btn: "2. è½‰é»ƒæœŸ", phase3_btn: "3. é¢¨å‘³ç™¼å±•æœŸ",
                matrix_title: "ğŸ§  æƒ…ç·’å­¸ç¿’å°ç…§è¡¨ (SEL Matrix)", matrix_desc: "å°‡çƒ˜ç„™çš„ç‰©ç†åŒ–å­¸è®ŠåŒ–ï¼Œå°æ‡‰åˆ°æ•™å¸«çš„æƒ…ç·’ç®¡ç†æ­·ç¨‹ã€‚",
                mind_title: "ğŸ§˜ å’–å•¡é¦™æ°£æ­£å¿µ", mind_subtitle: "æ¨¡æ“¬ Artisan æ›²ç·šç›£æ§ï¼šé»æ“Šä»¥ã€Œç©©å®šã€æ‚¨çš„ RoR",
                mind_hint: "ç•¶é»ƒè‰²åœ“åœˆæ“´å¤§æ™‚ (å£“åŠ›å‡æº«)ï¼Œé»æ“Šåœ“åœˆä¸­å¿ƒä»¥é€²è¡Œã€Œèª¿ç¯€å‘¼å¸ã€ã€‚",
                footer_quote: "ã€Œäº«å—é€™å€‹ã€å¤±æªã€èˆ‡ã€æ¢ç´¢ã€çš„æ­·ç¨‹ï¼Œå› ç‚ºæ‰€æœ‰çš„æŒ«æŠ˜ï¼Œæœ€çµ‚éƒ½æœƒæ¿ƒç¸®æˆä¸€æ¯ç¨ç‰¹çš„é¢¨å‘³ã€‚ã€",
                footer_link: "ğŸš€ æ¢ç´¢é‡Œæ­çš„å€‹äººå­¸ç¿’ç©ºé–“",
                chart_temp: "è±†æº« (Â°C)", chart_time: "æ™‚é–“ (åˆ†)",
                events: ['å…¥è±†', 'å›æº«é»', 'è½‰é»ƒ', 'æ¢…ç´å§‹', 'ç„¦ç³–å§‹', 'ä¸€çˆ†', 'äºŒçˆ†', 'çµæŸ'],
                sel_items: [
                    { title: "è„«æ°´æœŸ (Drying)", span: "å…¥è±† â†’ è½‰é»ƒ", phys: "å›æº«é»æ˜¯æœ€ä½è°·ã€‚æ’å‡ºæ°´åˆ†ã€‚", sel: "â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šå£“åŠ›èªçŸ¥èˆ‡æ¸…ç©º", sel_desc: "ç¶“æ­·ã€Œå›æº«é»ã€çš„ä½æ½®å¾Œï¼Œé–‹å§‹ç©©æ­¥å‡æº«ã€‚æ„è­˜åˆ°å£“åŠ›ï¼Œä¸¦ç‚ºæ–°çš„æ”¹è®Šåšæº–å‚™ã€‚" },
                    { title: "è½‰é»ƒæœŸ (Yellowing)", span: "è½‰é»ƒ â†’ æ¢…ç´å§‹", phys: "è±†å­è½‰é»ƒï¼Œæ¢…ç´åæ‡‰é–‹å§‹ã€‚é¢¨å‘³å‰é©…ç‰©ç”Ÿæˆã€‚", sel: "â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šè¦ºå¯Ÿèˆ‡æ ¡æº–", sel_desc: "é€²å…¥è¤‡é›œçš„åŒ–å­¸åæ‡‰å€ã€‚éœ€è¦é«˜å°ˆæ³¨åº¦ï¼Œå°‡ã€Œå¤±æªã€è¦–ç‚ºæ•¸æ“šé»ï¼Œé€²è¡Œç²¾æº–æ ¡æº–ã€‚" },
                    { title: "é¢¨å‘³ç™¼å±•æœŸ (Dev)", span: "ç„¦ç³–å§‹ â†’ äºŒçˆ†", phys: "ç„¦ç³–åŒ–ã€ä¸€çˆ†ã€äºŒçˆ†ã€‚å£“åŠ›å®Œå…¨é‡‹æ”¾ã€‚", sel: "â¤ï¸ æƒ…ç·’å°æ‡‰ï¼šé‡‹æ”¾èˆ‡å¹³è¡¡", sel_desc: "ä¸€çˆ†æ˜¯å£“åŠ›é‡‹æ”¾ã€‚æ­¤å¾Œéœ€ç©©å®š RoRï¼Œåœ¨ç†±æƒ… (é…¸è³ª) èˆ‡ç©©å®š (é†‡åšåº¦) é–“æ‰¾åˆ°å¹³è¡¡ã€‚" }
                ],
                cost_title: "å¤–è³¼ç²¾å“è±†", cost_self: "è‡ªå·±çƒ˜ç„™", cost_y: "æ¯åŠç£…æˆæœ¬ (NT$)", cost_main: "æˆæœ¬æ¯”è¼ƒï¼šå·¨å¤§çš„è¡Œå‹•å‹•åŠ›"
            },
            en: {
                nav_origin: "Origin", nav_journey: "Roast Journey", nav_sel: "SEL",
                hero_title: "From Latte Art to Roasted Gold", hero_desc: "This is more than a change in coffee flavor; it's a journey of awareness, struggle, and balance.<br>Facing the purity of black coffee, we learn to face our true selves and stress.",
                hero_btn: "Explore Roast Curve",
                journey_title: "ğŸ”¥ Roasting Curve", journey_desc: "Click chart phases to explore the journey. Includes key events like Turning Point and Yellowing.",
                phase1_btn: "1. Drying", phase2_btn: "2. Yellowing", phase3_btn: "3. Development",
                matrix_title: "ğŸ§  SEL Matrix", matrix_desc: "Mapping physical roasting changes to emotional management processes for educators.",
                mind_title: "ğŸ§˜ Aroma Mindfulness", mind_subtitle: "Simulating Artisan Monitor: Click to 'stabilize' your RoR",
                mind_hint: "When the yellow circle expands (rising pressure), click the center to 'regulate breathing'.",
                footer_quote: "ã€ŒEnjoy the process of 'losing way' and 'exploration', for all setbacks eventually concentrate into a unique flavor.ã€",
                footer_link: "ğŸš€ Explore Leo's Learning Space",
                chart_temp: "Bean Temp (Â°C)", chart_time: "Time (min)",
                events: ['Charge', 'Turning Point', 'Yellowing', 'Maillard Start', 'Caramel Start', 'First Crack', 'Second Crack', 'End'],
                sel_items: [
                    { title: "Drying Phase", span: "Charge â†’ Yellow", phys: "TP is the lowest point. Removing moisture.", sel: "â¤ï¸ Emotional: Recognition & Clearing", sel_desc: "After the low of 'Turning Point', start rising steadily. Recognize stress and prepare for change." },
                    { title: "Yellowing Phase", span: "Yellow â†’ Maillard", phys: "Beans turn yellow; Maillard begins. Flavor precursors form.", sel: "â¤ï¸ Emotional: Awareness & Calibration", sel_desc: "Entering complex reactions. Requires focus; view 'setbacks' as data points for precision calibration." },
                    { title: "Development Phase", span: "Caramel â†’ 2nd Crack", phys: "Caramelization and cracks. Total pressure release.", sel: "â¤ï¸ Emotional: Release & Balance", sel_desc: "Cracks are the release of pressure. Stabilize RoR to find the balance between acidity and body." }
                ],
                cost_title: "Premium Beans", cost_self: "Home Roasted", cost_y: "Cost / Half Lb (NT$)", cost_main: "Cost Comparison: The Catalyst for Action"
            }
        };

        // --- State ---
        const state = {
            lang: 'zh',
            currentPhase: 'drying',
            chartInstance: null,
            costChartInstance: null,
            mindfulness: { radius: 50, growing: true }
        };

        // --- Core Functions ---
        function toggleLanguage() {
            state.lang = state.lang === 'zh' ? 'en' : 'zh';
            document.getElementById('lang-toggle-text').innerText = state.lang === 'zh' ? 'EN' : 'ZH';
            updateUI();
        }

        function updateUI() {
            // Update static elements
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.innerHTML = i18n[state.lang][key];
            });

            // Update SEL Matrix
            const matrixContainer = document.getElementById('sel-matrix-container');
            matrixContainer.innerHTML = i18n[state.lang].sel_items.map(item => `
                <div class="group p-4 border border-gray-200 rounded-lg hover:bg-amber-50 transition cursor-pointer">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-bold text-lg text-amber-800">${item.title}</h4>
                        <span class="text-xs bg-gray-200 px-2 py-1 rounded">${item.span}</span>
                    </div>
                    <p class="text-gray-600 text-sm mb-2"><strong>Physical:</strong> ${item.phys}</p>
                    <div class="pl-4 border-l-2 border-amber-500">
                        <p class="text-amber-700 font-medium text-sm">${item.sel}</p>
                        <p class="text-gray-500 text-xs mt-1">${item.sel_desc}</p>
                    </div>
                </div>
            `).join('');

            // Update Chart and Dynamic Content
            initRoastChart();
            updatePhase(state.currentPhase);
        }

        const roastData = {
            times: ['0:00', '1:00', '2:00', '3:00', '4:00', '5:00', '6:00', '7:00', '8:00', '9:00', '10:00', '11:00'],
            temps: [200, 140, 100, 115, 145, 160, 175, 188, 198, 203, 208, 210],
            eventIdx: [0, 2, 3, 4, 6, 8, 10, 11]
        };

        function initRoastChart() {
            const ctx = document.getElementById('roastCurveChart').getContext('2d');
            if (state.chartInstance) state.chartInstance.destroy();

            const labels = roastData.times.map((t, i) => {
                const eventIdx = roastData.eventIdx.indexOf(i);
                return eventIdx !== -1 ? `${t} ${i18n[state.lang].events[eventIdx]}` : t;
            });

            state.chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: roastData.temps,
                        borderColor: '#8b4513',
                        backgroundColor: 'rgba(139, 69, 19, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: labels.map((_, i) => roastData.eventIdx.includes(i) ? '#a0522d' : '#fff'),
                        pointRadius: labels.map((_, i) => roastData.eventIdx.includes(i) ? 6 : 4),
                        fill: true, tension: 0.2
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { title: { display: true, text: i18n[state.lang].chart_temp }, min: 80, max: 220 },
                        x: { title: { display: true, text: i18n[state.lang].chart_time } }
                    },
                    onClick: (e, el) => {
                        if (el.length) {
                            const i = el[0].index;
                            if (i <= 3) updatePhase('drying');
                            else if (i === 4) updatePhase('yellowing');
                            else updatePhase('development');
                        }
                    }
                }
            });
        }

        const phaseContent = {
            zh: {
                drying: { title: "ç¬¬ä¸€éƒ¨ï¼šè„«æ°´æœŸ", sub: "å£“åŠ›æœ€ä½è°·", body: "çƒ˜ç„™åˆæœŸï¼Œè±†æº«ç¶“æ­·æˆ²åŠ‡æ€§ä¸‹é™è§¸åŠå›æº«é»ã€‚æƒ…ç·’ä¸Šï¼Œé€™æ˜¯é©æ‡‰æœŸï¼Œå¿…é ˆè„«å»èˆŠæœ‰ä¾è³´æ‰èƒ½é–‹å§‹å‡æº«ã€‚" },
                yellowing: { title: "ç¬¬äºŒéƒ¨ï¼šè½‰é»ƒæœŸ", sub: "é¢¨å‘³èµ·å§‹é»", body: "è±†å­è½‰é»ƒæ¨™èªŒæ¢…ç´åæ‡‰é–‹å§‹ã€‚æˆæœ¬å£“åŠ›ä¿ƒä½¿æˆ‘é€²å…¥æ•¸ä½åŒ–é ˜åŸŸï¼Œè¿½æ±‚ç²¾æº–åº¦ä»¥é¿å…å¤±æªã€‚" },
                development: { title: "ç¬¬ä¸‰éƒ¨ï¼šé¢¨å‘³ç™¼å±•æœŸ", sub: "é‡‹æ”¾èˆ‡å¹³è¡¡", body: "æ­¤éšæ®µæ­·ç¶“ä¸€çˆ†äºŒçˆ†ã€‚å£“åŠ›é‡‹æ”¾å¾Œå¿…é ˆå¿«é€Ÿèª¿ç¯€ RoRï¼Œåœ¨ç†±æƒ…èˆ‡ç©©å®šé–“å°‹æ‰¾å¹³è¡¡ã€‚" }
            },
            en: {
                drying: { title: "Phase 1: Drying", sub: "The Low Point", body: "Temp drops to the Turning Point. Emotionally, this is an adaptation phase. We must shed old dependencies before rising." },
                yellowing: { title: "Phase 2: Yellowing", sub: "Aroma Origin", body: "Maillard begins as beans turn yellow. Cost pressure drove my digital shift to Arduino for precision calibration." },
                development: { title: "Phase 3: Development", sub: "Release & Balance", body: "Cracks release pressure. Post-crack, we must regulate RoR to balance acidity (passion) and body (stability)." }
            }
        };

        function updatePhase(p) {
            state.currentPhase = p;
            document.querySelectorAll('.phase-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${p}`).classList.add('active');

            const data = phaseContent[state.lang][p];
            const container = document.getElementById('dynamic-content');
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-amber-900 mb-2">${data.title}</h3>
                <h4 class="text-lg text-amber-600 mb-6 font-medium">${data.sub}</h4>
                <p class="text-gray-700 leading-relaxed">${data.body}</p>
                ${p === 'yellowing' ? '<div class="h-64 mt-6"><canvas id="costChart"></canvas></div>' : ''}
            `;
            if (p === 'yellowing') setTimeout(initCostChart, 100);
        }

        function initCostChart() {
            const ctx = document.getElementById('costChart');
            if (!ctx) return;
            if (state.costChartInstance) state.costChartInstance.destroy();
            state.costChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [i18n[state.lang].cost_title, i18n[state.lang].cost_self],
                    datasets: [{ data: [500, 150], backgroundColor: ['#ef4444', '#22c55e'] }]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, title: { display: true, text: i18n[state.lang].cost_main } }
                }
            });
        }

        function initMindfulness() {
            const canvas = document.getElementById('mindfulnessCanvas');
            const ctx = canvas.getContext('2d');
            const centerX = 150, centerY = 150;

            canvas.onclick = () => {
                state.mindfulness.radius = Math.max(30, state.mindfulness.radius - 20);
                state.mindfulness.growing = true;
            };

            function animate() {
                ctx.clearRect(0, 0, 300, 300);
                ctx.beginPath(); ctx.arc(centerX, centerY, 80, 0, Math.PI * 2);
                ctx.strokeStyle = 'rgba(255,255,255,0.1)'; ctx.stroke();

                if (state.mindfulness.growing) {
                    state.mindfulness.radius += 0.3;
                    if (state.mindfulness.radius > 100) state.mindfulness.growing = false;
                } else {
                    state.mindfulness.radius -= 0.2;
                    if (state.mindfulness.radius < 40) state.mindfulness.growing = true;
                }

                const g = ctx.createRadialGradient(centerX, centerY, 10, centerX, centerY, state.mindfulness.radius);
                g.addColorStop(0, '#f59e0b'); g.addColorStop(1, 'rgba(245, 158, 11, 0.1)');
                ctx.beginPath(); ctx.arc(centerX, centerY, state.mindfulness.radius, 0, Math.PI * 2);
                ctx.fillStyle = g; ctx.fill();
                ctx.fillStyle = "white"; ctx.font = "14px monospace"; ctx.textAlign = "center";
                ctx.fillText(`RoR: ${(state.mindfulness.growing ? '+' : '-')}${Math.abs(state.mindfulness.radius / 10).toFixed(1)}`, centerX, centerY + 5);
                requestAnimationFrame(animate);
            }
            animate();
        }

        function scrollToSection(id) { document.getElementById(id).scrollIntoView({ behavior: 'smooth' }); }

        document.addEventListener('DOMContentLoaded', () => {
            updateUI();
            initMindfulness();
        });
    </script>
</body>
</html>
